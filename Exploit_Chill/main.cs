using System;
using System.Collections;
using System.Collections.Generic;
using System.ComponentModel;
using System.Data;
using System.Drawing;
using System.Linq;
using System.Text;
using System.Threading.Tasks;
using System.Windows.Forms;

namespace Exploit_Chill
{
    public partial class main : Form
    {
        ArrayList players;
        int counter;
        int round;
        int roundOver;
        string pName;
        Bitmap chill;
        Bitmap exploit;

        public main()
        {
            InitializeComponent();

            //internal turn counter
            counter = 0;
            round = 1;
            button1.Enabled = false;
            button2.Enabled = false;
            button3.Enabled = false;

            //Images to at least provide fun while 'playing'
            chill = new Bitmap("..\\Resources\\Images\\cat.jpg");
            exploit = new Bitmap("..\\Resources\\Images\\gold.jpg");

        }

        private void button1_Click(object sender, EventArgs e)
        {
            Player temp = (Player)players[counter % 3];
            temp.d_choice = 'C';
            pictureBox2.Image = chill;
            randomQuotes(temp.d_choice);
            counter++;
            button1.Enabled = false;
            button2.Enabled = false;
            button3.Enabled = true;
        }

        private bool endGame()
        {
            if (round > roundOver)
                return true;
            else
                return false;
        }

        private void button2_Click(object sender, EventArgs e)
        {
            Player temp = (Player)players[counter % 3];
            temp.d_choice = 'E';
            pictureBox2.Image = exploit;
            randomQuotes(temp.d_choice);
            counter++;
            button1.Enabled = false;
            button2.Enabled = false;
            button3.Enabled = true;
        }

        private void button3_Click(object sender, EventArgs e)
        {
            if (counter % 3 == 0)
            {
                Player temp = (Player)players[counter % 3];
                button3.Enabled = false;
                button1.Enabled = true;
                button2.Enabled = true;
                pictureBox1.Image = temp.this_Pic;
                label3.Text = Convert.ToString(temp.d_name);
                updateRound();
            }
            else {
                run_Next();
            }
        }
        private void updateRound()
        {
            round++;
            label16.Text = Convert.ToString(round);
            updateScore();
            if(endGame())
            {
                label16.Text = "Done";
                MessageBox.Show("Alert", "Winner!");

            }
        }

        public void updateScore()
        {
            //All exploits (10,15,14)
            //Player Chill, both CPU exploits (5, -7, 8)
            //Player and CPU2 exploits, CPU1 chills (-3,2,-5)
            //Player and CPU1 chills, CPU2 Exploits (9,-3,0)

            //Player and CPU1 exploits, CPU2 Chills (-4,-6,-3)
            //Player and CPU2 chills, CPU1 exploits (2,1,6)
            //Player exploits, CPU1 and CPU2 chills (6,-3,2)
            //All chills (-2,4,-1)
            Player a = (Player)players[0];
            CPU_Player b = (CPU_Player)players[1];
            CPU_Player c = (CPU_Player)players[2];
            int num = Convert.ToInt32(label10.Text);
            int num1= Convert.ToInt32(label14.Text);
            int num2= Convert.ToInt32(label11.Text);

            //10,14,11
            switch (a.d_choice)
            {
                case 'E':
                    if (b.d_choice == 'E')
                    {
                        if (c.d_choice == 'E')
                        {
                            num += 10;
                            num1 += 15;
                            num2 += 14;
                            label10.Text = Convert.ToString(num);
                            label14.Text = Convert.ToString(num1);
                            label11.Text = Convert.ToString(num2);
                        }
                        if( c.d_choice == 'C')
                        {
                            num += -4;
                            num1 += -6;
                            num2 += -3;
                            label10.Text = Convert.ToString(num);
                            label14.Text = Convert.ToString(num1);
                            label11.Text = Convert.ToString(num2);
                        }
                    }
                    if(b.d_choice=='C')
                    {
                        if (c.d_choice == 'E')
                        {
                            num += -3;
                            num1 += 2;
                            num2 += -5;
                            label10.Text = Convert.ToString(num);
                            label14.Text = Convert.ToString(num1);
                            label11.Text = Convert.ToString(num2);
                        }
                        if (c.d_choice == 'C')
                        {
                            num += 6;
                            num1 += -3;
                            num2 += 2;
                            label10.Text = Convert.ToString(num);
                            label14.Text = Convert.ToString(num1);
                            label11.Text = Convert.ToString(num2);
                        }
                    }
                    break;
                case 'C':
                    if (b.d_choice == 'E')
                    {
                        if (c.d_choice == 'E')
                        {
                            num += 5;
                            num1 += -7;
                            num2 += 8;
                            label10.Text = Convert.ToString(num);
                            label14.Text = Convert.ToString(num1);
                            label11.Text = Convert.ToString(num2);
                        }
                        if (c.d_choice == 'C')
                        {
                            num += 2;
                            num1 += 1;
                            num2 += 6;
                            label10.Text = Convert.ToString(num);
                            label14.Text = Convert.ToString(num1);
                            label11.Text = Convert.ToString(num2);
                        }
                    }
                    if (b.d_choice == 'C')
                    {
                        if (c.d_choice == 'E')
                        {
                            num += 9;
                            num1 += -3;
                            num2 += 0;
                            label10.Text = Convert.ToString(num);
                            label14.Text = Convert.ToString(num1);
                            label11.Text = Convert.ToString(num2);
                        }
                        if (c.d_choice == 'C')
                        {
                            num += -2;
                            num1 += 4;
                            num2 += -1;
                            label10.Text = Convert.ToString(num);
                            label14.Text = Convert.ToString(num1);
                            label11.Text = Convert.ToString(num2);
                        }
                    }
                    break;
            }



        }

        private void run_Next()
        {
            CPU_Player temp = (CPU_Player)players[counter % 3];
            if (counter % 3 == 1)
            {
                temp.d_choice = 'E';
                pictureBox2.Image = exploit;
            }
            else {
                temp.d_choice = 'C';
                pictureBox2.Image = chill;
            }
            pictureBox1.Image = temp.this_Pic;
            label3.Text = temp.d_name + "'s";
            randomQuotes(temp.d_choice);
            Console.Write(counter);
            counter++;
        }

        private void setValuesToolStripMenuItem_Click(object sender, EventArgs e)
        {
            try {
                roundOver = Convert.ToInt32(textBox1.Text);
                button3.Enabled = false;
                button1.Enabled = true;
                button2.Enabled = true;
                label12.Text = "";
            }
            catch (Exception) { label12.Text = "Enter valid integer on rounds."; }
            pName = textBox2.Text;

            //setting up cpu player name and images
            players = new ArrayList();
            Bitmap a = new Bitmap("..\\Resources\\Images\\blind-item.jpg");
            players.Add(new Player(pName, a));
            a = new Bitmap("..\\Resources\\Images\\kguya.jpg");
            players.Add(new CPU_Player("Kaguya", a));
            a = new Bitmap("..\\Resources\\Images\\orekii.jpg");
            players.Add(new CPU_Player("Oreki", a));

            //display player image
            Player temp = (Player)players[0];
            pictureBox1.Image = temp.this_Pic;
            label3.Text = temp.d_name+"'s";


        }
        public void randomQuotes(char choice)
        {
            string [] quotesExp = new string[] { "Ahemm you wanna exploit! Go get them mortal!", "Find them keepers!", "Tsk! So you only know of greed."};
            string[] quotesChil = new string[] { "As cool as the sea breeze.", "Have you ever wonder a life where to live is to sleep?", "YES! YES! There's gold in patience!!!" };
            Random q = new Random(); ;
            int g;
            if (choice == 'E')
            {
                label2.Text = quotesExp[q.Next(0,quotesExp.Length)];
            }
            else {
                label2.Text = quotesChil[q.Next(0, quotesChil.Length)];
            }
            
        }
    }
}
